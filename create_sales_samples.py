import pandas as pd
import os
from datetime import datetime, timedelta

# 판매계획 샘플 데이터 생성
def create_sales_plan_samples():
    output_dir = "C:/MYCLAUDE_PROJECT/NEW_APS/data/samples"
    os.makedirs(output_dir, exist_ok=True)
    
    # 1. 기넥신에프정 중심 판매계획
    data1 = []
    base_date = datetime(2025, 2, 1)  # 2025년 2월
    
    ginexin_products = [
        {"제품코드": "500002", "제품명": "기넥신에프정 40mg 100T", "제조번호": "00125", "수량": 10000},
        {"제품코드": "500005", "제품명": "기넥신에프정 40mg 300T", "제조번호": "00225", "수량": 30000},
        {"제품코드": "500005", "제품명": "기넥신에프정 40mg 300T", "제조번호": "00325", "수량": 30000},
        {"제품코드": "500002", "제품명": "기넥신에프정 40mg 100T", "제조번호": "00425", "수량": 10000},
        {"제품코드": "500002", "제품명": "기넥신에프정 40mg 100T", "제조번호": "00525", "수량": 10000},
        {"제품코드": "500005", "제품명": "기넥신에프정 40mg 300T", "제조번호": "00625", "수량": 30000},
        {"제품코드": "500008", "제품명": "기넥신에프정 80mg 100T", "제조번호": "01725", "수량": 10000},
        {"제품코드": "500008", "제품명": "기넥신에프정 80mg 100T", "제조번호": "01855", "수량": 10000},
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "01925", "수량": 50000},
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "02025", "수량": 50000},
    ]
    
    for i, product in enumerate(ginexin_products):
        delivery_date = base_date + timedelta(days=i*2)
        data1.append({
            "제품코드": product["제품코드"],
            "제품명": product["제품명"],
            "제조번호": product["제조번호"],
            "수량": product["수량"],
            "납기일": delivery_date.strftime("%Y-%m-%d"),
            "우선순위": "긴급" if i < 3 else "보통"
        })
    
    df1 = pd.DataFrame(data1)
    df1.to_excel(f"{output_dir}/sales_plan_ginexin_202502.xlsx", index=False, sheet_name="판매계획")
    
    # 2. 혼합 제품 판매계획
    data2 = []
    base_date = datetime(2025, 2, 3)
    
    mixed_products = [
        {"제품코드": "500023", "제품명": "리넥신정 80/100mg 300T", "제조번호": "00125", "수량": 30000},
        {"제품코드": "500024", "제품명": "리넥신정 80/100mg 30T", "제조번호": "00225", "수량": 3000},
        {"제품코드": "507012", "제품명": "리넥신서방정 30T", "제조번호": "00125", "수량": 3000},
        {"제품코드": "507013", "제품명": "리넥신서방정 300T", "제조번호": "00325", "수량": 30000},
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "01725", "수량": 50000},
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "01825", "수량": 50000},
        {"제품코드": "507123", "제품명": "페브릭정 40mg 30T", "제조번호": "00725", "수량": 3000},
        {"제품코드": "505090", "제품명": "페브릭정 40mg 100T", "제조번호": "00825", "수량": 10000},
        {"제품코드": "507242", "제품명": "신플랙스세이프정 100T", "제조번호": "24059", "수량": 10000},
        {"제품코드": "505871", "제품명": "신플랙스세이프정 30T", "제조번호": "25006", "수량": 3000},
    ]
    
    for i, product in enumerate(mixed_products):
        delivery_date = base_date + timedelta(days=i*3)
        data2.append({
            "제품코드": product["제품코드"],
            "제품명": product["제품명"],
            "제조번호": product["제조번호"],
            "수량": product["수량"],
            "납기일": delivery_date.strftime("%Y-%m-%d"),
            "우선순위": "긴급" if "조인스정" in product["제품명"] else "보통"
        })
    
    df2 = pd.DataFrame(data2)
    df2.to_excel(f"{output_dir}/sales_plan_mixed_202502.xlsx", index=False, sheet_name="판매계획")
    
    # 3. 대량 생산 계획
    data3 = []
    base_date = datetime(2025, 2, 1)
    
    bulk_products = [
        # 기넥신에프정 80mg 500T 대량 생산
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "02225", "수량": 50000},
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "02325", "수량": 50000},
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "02425", "수량": 50000},
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "02525", "수량": 50000},
        {"제품코드": "505227", "제품명": "기넥신에프정 80mg 500T", "제조번호": "02625", "수량": 50000},
        # 조인스정 대량 생산
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "02225", "수량": 50000},
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "02325", "수량": 50000},
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "02425", "수량": 50000},
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "02525", "수량": 50000},
        {"제품코드": "500041", "제품명": "조인스정 200mg 500T", "제조번호": "02625", "수량": 50000},
    ]
    
    for i, product in enumerate(bulk_products):
        delivery_date = base_date + timedelta(days=i*2)
        data3.append({
            "제품코드": product["제품코드"],
            "제품명": product["제품명"],
            "제조번호": product["제조번호"],
            "수량": product["수량"],
            "납기일": delivery_date.strftime("%Y-%m-%d"),
            "우선순위": "긴급"
        })
    
    df3 = pd.DataFrame(data3)
    df3.to_excel(f"{output_dir}/sales_plan_bulk_202502.xlsx", index=False, sheet_name="판매계획")
    
    # 4. 소량 다품종 계획
    data4 = []
    base_date = datetime(2025, 2, 5)
    
    small_batch_products = [
        {"제품코드": "500002", "제품명": "기넥신에프정 40mg 100T", "제조번호": "00725", "수량": 10000},
        {"제품코드": "500024", "제품명": "리넥신정 80/100mg 30T", "제조번호": "00425", "수량": 3000},
        {"제품코드": "507012", "제품명": "리넥신서방정 30T", "제조번호": "00525", "수량": 3000},
        {"제품코드": "507123", "제품명": "페브릭정 40mg 30T", "제조번호": "00825", "수량": 3000},
        {"제품코드": "507124", "제품명": "페브릭정 80mg 30T", "제조번호": "00425", "수량": 3000},
        {"제품코드": "505871", "제품명": "신플랙스세이프정 30T", "제조번호": "25007", "수량": 3000},
        {"제품코드": "500008", "제품명": "기넥신에프정 80mg 100T", "제조번호": "04925", "수량": 10000},
        {"제품코드": "505090", "제품명": "페브릭정 40mg 100T", "제조번호": "01125", "수량": 10000},
    ]
    
    for i, product in enumerate(small_batch_products):
        delivery_date = base_date + timedelta(days=i*2)
        data4.append({
            "제품코드": product["제품코드"],
            "제품명": product["제품명"],
            "제조번호": product["제조번호"],
            "수량": product["수량"],
            "납기일": delivery_date.strftime("%Y-%m-%d"),
            "우선순위": "보통"
        })
    
    df4 = pd.DataFrame(data4)
    df4.to_excel(f"{output_dir}/sales_plan_small_batch_202502.xlsx", index=False, sheet_name="판매계획")
    
    print("판매계획 샘플 파일 생성 완료:")
    print(f"1. {output_dir}/sales_plan_ginexin_202502.xlsx - 기넥신에프정 중심")
    print(f"2. {output_dir}/sales_plan_mixed_202502.xlsx - 혼합 제품")
    print(f"3. {output_dir}/sales_plan_bulk_202502.xlsx - 대량 생산")
    print(f"4. {output_dir}/sales_plan_small_batch_202502.xlsx - 소량 다품종")

if __name__ == "__main__":
    create_sales_plan_samples()