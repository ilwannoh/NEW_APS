# APS 생산계획 프로그램 요구사항 정리
> **목적**  
> 판매계획(수요)·자원(인원·장비)·제약조건을 입력하면 **“초안”** 생산계획을 자동 산출하고,  
> 담당자가 시각적으로 검토·수정(드래그&드롭)한 뒤 확정할 수 있는 시스템을 구축한다.  
> 개발·코드 리뷰는 **클로드 코드(Claude Code)** 환경에서 진행하며, 본 문서는 그대로 붙여넣어 사용할 수 있는 *마크다운 스펙*이다.

---

## 1. 입력 데이터

| 구분 | 파일/소스 | 필수 필드 | 비고 |
|------|-----------|-----------|------|
| **판매계획** | Excel (`plan.xlsx`) | `제품명`, `월별_필요_배치수` | 월 단위 수요 |
| **기존 생산계획** | Excel (`manplan1.xlsx`) | 배치별 일정 및 장비 배정 | 레거시 참고용 |
| **마스터 데이터 (UI에서 CRUD)** | DB or JSON | 아래 항목 참조 | 하드코딩 금지 |

### 1.1 마스터 데이터 상세
- **제품(Product)**
  - `제품ID`, `제품명`, `우선순위`, `주요_장비목록`, `공정순서`, `표준_리드타임(hr)`  
- **공정(Process)**
  - `공정ID`, `공정명` *(예: 계량‣혼합‣타정‣코팅‣선별‣포장)*, `순서`
- **장비(Equipment)**
  - `장비ID`, `장비명`, `공정ID`, `가능_제품`, `세척_필요여부`, `사용제한(기간)`
- **작업자(Operator)**
  - `공정ID`, `날짜`, `출근인원`, `1인당_일_처리가능_배치수(기본값)`  

> **⚙️ 설정 UI 요구**  
> - 제품·공정·장비·작업자 정보를 *동적으로* 추가/수정/삭제  
> - 작업자 수에 따른 **당일 공정별 최대 처리량** 자동 계산  
> - `1인당_배치처리_비율` 조정 슬라이더(Ex: 기본 2배치/일 → 상황별 1.5배치/일)  

---

## 2. 핵심 스케줄링 로직 (1차 MVP)

1. **수요 해석**  
   - 판매계획에서 월별 배치 수요 → 일‧공정 단위로 분할
2. **장비 선호도**  
   - `제품 ↔ 주요_장비목록` 우선 배정, 불가 시 대체 장비 허용
3. **작업자 제약**  
   - `출근인원 × 1인당_일_처리량` ≤ 해당 공정의 **일일 최대 배치수**
4. **시간 그리드**  
   - **블록 단위**: 1 블록 = 1 배치 = 8 시간(4h AM + 4h PM)  
   - 잔업 발생 시 **블록 초과** 허용(시각적 표시만, 추가 계산 X)
5. **세척 & 장비 가동중지**
   - 제품 변경 시 `세척_블록(작업자 2명, 시간 가중치 포함)` 삽입 *(단계적 구현)*  
   - 장비 사용 제한 기간은 스케줄러가 해당 슬롯을 **금지 영역**으로 표시
6. **출력**  
   - **그리드 뷰**: A열=장비, 1행=날짜, 셀= `제품_약어,Batch#`  
   - 장비·공정·제품별 **색상 코드**로 시각화  
   - **드래그&드롭**으로 셀 이동 → 실시간 제약 재검증

---

## 3. UI/UX 요구

| 화면 | 주요 기능 |
|------|----------|
| **① 마스터 설정** | 제품/공정/장비/작업자 CRUD, 세척/제약 조건 입력 |
| **② 스케줄 생성** | 판매계획 업로드 → “생산계획 초안” 버튼 → 그리드 생성 |
| **③ 스케줄 편집** | 드래그&드롭, 색상·툴팁, 제약 위반 실시간 알람 |
| **④ 데이터 변환** | 그리드 → 시계열 CSV/XML (`Date,Process,Equipment,Product,Batch`) |
| **⑤ 대시보드** *(2차)* | 장비 부하도, 가동률, 누적 생산량, 품질연계 차트 |
| **⑥ 리포트** *(3차)* | 대시보드 스냅샷 + AI 해석 ➜ PDF/Word 자동 생성 |

> **Note**: 초기 UI는 제공받은 오픈소스 프로젝트[POSS-dev]의 컴포넌트 재사용. Streamlit **불사용**.

---

## 4. 단계별 개발 로드맵

| 단계 | 범위 | 완료 기준 |
|------|------|-----------|
| **MVP (1차)** | 입력 처리, 마스터 설정 UI, 초안 스케줄러, 그리드 편집 | 월별 판매계획으로 일단위 계획 생성·수정 가능 |
| **고도화 (2차)** | 세척 로직, 장비 Downtime, 시계열 Export | 세척 블록·금지 영역 반영, ML용 데이터셋 추출 |
| **대시보드/AI (3차)** | 장비 부하도, 품질·가동률 분석, 보고서 | PDF/Word 자동 리포트, API Key 기반 AI 분석 |

---

## 5. 비기능 요구사항

- **성능**: 월 배치수 ≤ 500 기준 5 초 이내 초안 생성
- **확장성**: 제품 40+ 개, 공정/장비 추가 시 재배포 없이 UI로 등록
- **가독성**: 색상·툴팁·블록 크기로 현장 작업자도 즉시 이해
- **데이터 포맷**: 내부 네트워크·Excel 우선, 추후 DB 이관 고려
- **국제화**: UI 한글, 코드 내부 영문 식별자
- **테스트**: 유닛(로직) + E2E(UI 드래그) 자동화

---

## 6. 폴더·파일 구조 제안


---

## 7. Glossary

| 용어 | 정의 |
|------|------|
| **Batch(배치)** | 동일 제품을 한 번에 생산하는 최소 생산 단위 |
| **블록(Block)** | 그리드 한 칸(1 Batch = 1 블록 = 8 h) |
| **세척 블록** | 장비 제품 전환 시 투입되는 Cleaning 작업 블록 |
| **케파(Capacity)** | 공정·일자·인원 기준 최대 생산 가능 수량 |
| **Downtime** | 장비 점검·고장 등 사용 불가 기간 |

---

## 8. 요청·오픈이슈

1. **세척 블록 규칙 정의 필요**  
   - 세척 시간·인원·색상 등 상세 스펙 확정
2. **장비·공정 우선순위 알고리즘**  
   - 단순 Rule 기반 vs. Heuristic vs. MILP 비교 검토
3. **대시보드 툴 선택**  
   - Plotly Dash / Grafana / 기타 React 기반?

> 추가 세부사항·변경사항 발생 시 본 문서 업데이트 후 재공유 요망
## 9.  참고 오픈소스 코드 (매우 중요)

- 사용자(요청자)가 **직접 GitHub에서 수집한 유사 APS 프로젝트 코드**를 참고용으로 제공함
- 이 오픈소스 코드들은 UI 구성 방식, 데이터 구조, 생산계획표 표현 방식 등을 이해하는 데 중요하며,
  현재 요구된 기능들을 구현하는 데 강력한 **UI/UX 템플릿 및 로직 참고자료**로 활용해야 함
- 전체 코드는 클로드 환경의 **동일 경로**에 저장되어 있음

### 반드시 준수할 사항
- **기존 오픈소스 코드 전수 리뷰** 후 재사용 가능한 UI 컴포넌트, 로직, 디렉토리 구조를 적극 활용할 것
- 사용자의 요구사항과 차이가 있다면 오픈소스 기반 코드를 수정하되, 가독성과 유지보수를 고려할 것
- Streamlit 사용 금지 (기존 오픈소스에 Streamlit 포함되어 있다면 다른 프레임워크로 전환 필요)

> ⚠️ **개발 전 반드시 참고 코드 구조를 분석하고 보고서 형태로 요약한 뒤 착수할 것**
